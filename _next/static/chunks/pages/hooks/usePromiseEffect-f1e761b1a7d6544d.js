(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{6570:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/hooks/usePromiseEffect",function(){return c(90843)}])},98184:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{default:function(){return i},getConfig:function(){return l}});var d,e=(d=c(86248),d&&d.__esModule?d:{default:d});function f(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function g(a){for(var b=arguments,c=1;c<arguments.length;c++)!function(c){var d=null!=b[c]?b[c]:{},e=Object.keys(d);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(d).filter(function(a){return Object.getOwnPropertyDescriptor(d,a).enumerable}))),e.forEach(function(b){var c,e,f;c=a,e=b,f=d[b],e in c?Object.defineProperty(c,e,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[e]=f})}(c);return a}var h={onUnhandledError:function(a){console.error(a)},pagination:{pageStart:1,perPage:25}};function i(a){var b,c,d;h=(c=g({},h,a),d={pagination:g({pageStart:1,perPage:25},h.pagination,null!==(b=a.pagination)&& void 0!==b?b:{})},d=null!=d?d:{},Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(d)):(function(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);c.push.apply(c,d)}return c})(Object(d)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(d,a))}),c),j()}function j(){return k.apply(this,arguments)}function k(){var a;return(k=(a=e.default.mark(function a(){var b;return e.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:try{(b=c(32937)).config&&!b.config.onUnhandledError&&(b.config.onUnhandledError=function(a){return h.onUnhandledError(a,"rxjs")})}catch(d){}case 1:case"end":return a.stop()}},a)}),function(){var b=this,c=arguments;return new Promise(function(d,e){var g=a.apply(b,c);function h(a){f(g,d,e,h,i,"next",a)}function i(a){f(g,d,e,h,i,"throw",a)}h(void 0)})})).apply(this,arguments)}function l(){return h}},44151:function(a,b,c){"use strict";Object.defineProperty(b,"Z",{enumerable:!0,get:function(){return g}});var d=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=f(b);if(c&&c.has(a))return c.get(a);var d={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=e?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(d,g,h):d[g]=a[g]}return d.default=a,c&&c.set(a,d),d}(c(27378)),e=c(98184);function f(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(f=function(a){return a?c:b})(a)}function g(a,b){d.useEffect(function(){var b=!0;return a(function(){return b}).catch(function(a){throw(0,e.getConfig)().onUnhandledError(a,"hooks"),a}),function(){b=!1}},b)}},90843:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return m},meta:function(){return k}});var d=c(31373),e=c(27378),f=c(35318),g=c(56100),h=c(30222),i=c(38861),j=c(44151),k={name:"usePromiseEffect",tableOfContents:{depth:0,children:[{depth:1,slug:"#usepromiseeffect",title:"usePromiseEffect",children:[{depth:2,slug:"#como-usar",title:"Como usar"},{depth:2,slug:"#cuidados",title:"Cuidados"},{depth:2,slug:"#par\xe2metros-e-retorno",title:"Par\xe2metros e Retorno"}]}]}},l={meta:k};function m(a){var b=a.components,c=(0,d.Z)(a,["components"]);return(0,f.kt)("wrapper",Object.assign({},l,c,{components:b,mdxType:"MDXLayout"}),(0,f.kt)("h1",Object.assign({},{id:"usepromiseeffect"}),"usePromiseEffect"),(0,f.kt)("p",null,"D\xe1 Subscribe em uma promise e quando o componente desmonta (unmount) tamb\xe9m d\xe1 unsubscribe,\ndiminuindo assim o risco de Memory Leak. ",(0,f.kt)("strong",{parentName:"p"},"Como um useEffect")," ele n\xe3o ger\xe1 estado diminuindo o n\xfamero de renders."),(0,f.kt)("h2",Object.assign({},{id:"como-usar"}),"Como usar"),(0,f.kt)("pre",null,(0,f.kt)("code",Object.assign({parentName:"pre"},{className:"language-tsx"}),"usePromiseEffect(async isSubscribed => {\n  await userService.get();\n\n  if (isSubscribed()) {\n    //set some state\n  }\n}, []);\n\nreturn (\n  <div>\n    {loading ? 'Carregando' : ''}\n    {value}\n  </div>\n);\n")),(0,f.kt)(g.X,{__position:0,code:"() => {\n  const [loading, setLoading] = useState(false)\n  usePromiseEffect((isSubscribed) => {\n    setLoading(true)\n    return new Promise((resolve) =>\n      setTimeout(() => resolve('ol\xe1'), 2000),\n    ).then(() => {\n      if (isSubscribed()) setLoading(false)\n    })\n  }, [])\n  return <div>Loading: {loading.toString()}</div>\n}",scope:{props:c,useState:e.useState,useCallback:e.useCallback,Playground:g.X,Button:h.Z,Typography:i.default,usePromiseEffect:j.Z,meta:k},mdxType:"Playground"},function(){var a=(0,e.useState)(!1),b=a[0],c=a[1];return(0,j.Z)(function(a){return c(!0),new Promise(function(a){return setTimeout(function(){return a("ol\xe1")},2e3)}).then(function(){a()&&c(!1)})},[]),(0,f.kt)("div",null,"Loading: ",b.toString())}),(0,f.kt)("h2",Object.assign({},{id:"cuidados"}),"Cuidados"),(0,f.kt)("ul",null,(0,f.kt)("li",{parentName:"ul"},(0,f.kt)("strong",{parentName:"li"},"Erros")," ocorridos ser\xe3o automaticamentes logados e as o ",(0,f.kt)("strong",{parentName:"li"},"onUnhandledError")," no ",(0,f.kt)("strong",{parentName:"li"},"setHoustonHooksConfig"),"\nfor setado.")),(0,f.kt)("h2",Object.assign({},{id:"par\xe2metros-e-retorno"}),"Par\xe2metros e Retorno"),(0,f.kt)("pre",null,(0,f.kt)("code",Object.assign({parentName:"pre"},{className:"language-ts"}),"/**\n * @param promiseGenerator Fun\xe7\xe3o que retorna uma Promise\n * @param deps Lista de depend\xeancias\n * @returns undefined\n */\nexport default usePromiseEffect<T>(promiseGenerator: (isSubscribed: () => boolean) => Promise<T>, deps: React.DependencyList): void;\n")))}m.isMDXComponent=!0;var n={editThisPagePath:"src/pages/hooks/usePromiseEffect/index.mdx"};for(var o in n)window[o]=n[o]}},function(a){a.O(0,[526,618,885,194,109,995,774,888,179],function(){var b;return a(a.s=6570)}),_N_E=a.O()}])